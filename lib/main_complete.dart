// سأضع الكود الكامل في الرسالة التالية بسبب الطول
